<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tic Tac Toe</title>
    <style>
        td {
            padding: 15px;
        }
    </style>
</head>
<body>
<h3>Tic Tac Toe</h3>
<div id="boardgame"></div>
<br>
<input type="button" id="btnTurn" value="Đánh X" onclick="changeValue()">
<script>
    let boardHTML = document.getElementById("boardgame");
    let buttonHTML = document.getElementById("btnTurn");
    let board = [[".", ".", "."], [".", ".", "."], [".", ".", "."]];
    let isNextX = true; // X lượt tiếp theo

    function show() {
        let hienThi = "";
        hienThi += "<table border='2'>";
        // console.log(board);
        for (let i = 0; i < 3; i++) {
            hienThi += "<tr>";
            for (let j = 0; j < 3; j++) {
                hienThi += "<td>" + board[i][j] + "</td>";
            }
            hienThi += "</tr>";
        }
        hienThi += "</table>";
        return hienThi;
    }

    // console.log(hienThi);
    boardHTML.innerHTML = show();

    function changeValue() {
        let x;
        let y;
        let s; // "X" or "O"
        //validate x y
        do {
            x = parseInt(prompt("Nhạp x"));
            y = parseInt(prompt("Nhập y"));
        } while (x < 0 || x > 2 || y < 0 || y > 2);
        // thay đổi giá trị X hoặc O trong mảng board
        if (board[x][y] === '.') {
            if (isNextX) {
                s = "X";
                buttonHTML.value = "Đến lượt O";
            } else {
                s = "O";
                buttonHTML.value = "Đến lượt X";
            }
            board[x][y] = s;
            boardHTML.innerHTML = show(); // update board game
            if (checkWin(x, y, s)) {
                alert(s + " WIN");
                buttonHTML.disabled = true;
            } else {
                isNextX = !isNextX;
            }
        } else {
            alert("Ô này đã đánh. Không thể ghi đè");
        }
        // toggle x -> o hoặc o -> x
    }

    function checkWin(x, y, s) {
        //[0][0] && [0][1] && [0][2]
        //[1][0] && [1][1] && [1][2]
        //[2][0] && [2][1] && [2][2]
        for (let i = 0; i < 3; i++) {
            if (board[x][i] !== s) {
                break;
            }
            if (i === 2) {
                return true;
            }
        }
        //[0][0] && [1][0] && [2][0]
        //[0][1] && [1][1] && [2][1]
        //[0][2] && [1][2] && [2][2]
        for (let i = 0; i < 3; i++) {
            if (board[i][y] !== s) {
                break;
            }
            if (i === 2) {
                return true;
            }
        }
        //[0][0] && [1][1] && [2][2]
        if (x === y) {
            for (let i = 0; i < 3; i++) {
                if (board[i][i] !== s)
                    break;
                if (i === 2) {
                    return true;
                }
            }
        }
        //[0][2] && [1][1] && [2][0]
        if (x + y === 2) {
            for (let i = 0; i < 3; i++) {
                if (board[i][2 - i] !== s)
                    break;
                if (i === 2) {
                    return true;
                }
            }
        }
        return false;
    }
</script>
</body>
</html>